qemu_tools
==========

Set of simple tools for qemu usage.  Specialized for kernel hacking using
qemu-kvm and would not fit for general usecase.


NOTE
====

These tools are developed and tested for the 'Ubuntu 16.04 Server' only.  May
not work well on other distributions.


Simple Tutorial
===============

Below simple commands will give you a virtual machine environment!

```
$ ./install.sh
$ ./mkimg.sh 32G my.disk
$ wget http://releases.ubuntu.com/16.04/ubuntu-16.04.6-server-amd64.iso
$ sudo ./startvm.sh --graphic --cdrom ubuntu-16.04.6-server-amd64.iso my.disk
```


install.sh
==========

`install.sh` fetches source code of qemu v3.0.0 and builds it.  It also
installs necessary packages.  Just type `./install.sh` on your command line.
Other tools in this repository will not work without that.


mkimg.sh
========

`mkimg.sh` make a qcow2 format disk image.  Usage is simple:

```
Usage: ./mkimg.sh <size> <image file path>
```

- `<size>`:	Size of the disk.  You may use 'G' for gibibytes.
		(e.g., 32G for 32 GiB)
`<image file path>`:	Path to the disk file that will be generated.


startvm.sh
==========

`startvm.sh` creates new virtual machine using qemu-kvm.  It's usage is simple
as below:

```
Usage: ./startvm.sh [OPTIONS] <path to disk file> [<nr_cores> [<ram size>]]
  --graphic       start vm in graphic mode
  --sshport       port for ssh server
  --cdrom         cdrom image
```

`<nr_cores>`: Number of virtual CPUs for the virtual machine.
	      Defaults to 16.
`<ram size>`: Size of ram for the virtual machine.  You can use 'G' or 'M'
	      suffix for Gibi-bytes and Mibi-bytes.
	      Defaults to 32G.
`--graphic`:  Start the virtual machine in graphic mode.
`--sshport`:  The tool forward 22 port of the virtual machine to this port of
	      host machine.  If you want ssh connection to the virtual machine,
	      you may use this port.
	      Defaults to 2242.
`--cdrom`:    Start the virtual machine as specified cdrom image is inserted.
              For installation CD images, please refer to
              https://www.debian.org/releases/,
              http://releases.ubuntu.com or
              https://dl.fedoraproject.org/pub/fedora/linux/releases/


Author
======

SeongJae Park <sj38.park@gmail.com>
